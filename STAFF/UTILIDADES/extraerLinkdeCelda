/**
 * @description: Extrae un enlace de una celda, ya sea que est√©
 * como texto directo o dentro de una f√≥rmula HYPERLINK.
 * @param {GoogleAppsScript.Spreadsheet.Range} rangoCelda El rango de la celda que contiene el enlace.
 * @returns {string} El enlace extra√≠do como una cadena de texto, o una cadena vac√≠a si no se encuentra.
 */
function STAFF_utilidades_extraerLinkDeCelda(rangoCelda) {
  if (!rangoCelda) return "";

  try {
    const formula = rangoCelda.getFormula();
    let link = "";

    if (formula) {
      // Si tiene f√≥rmula tipo HYPERLINK, extraer la URL entre comillas
      link = formula.match(/"(https:\/\/[^"]+)"/)?.[1] || "";
      Logger.log("üîç Link extra√≠do desde f√≥rmula HYPERLINK: " + link);
    } else {
      // Si no hay f√≥rmula, tomar el contenido directamente
      link = rangoCelda.getValue().toString().trim();
      Logger.log("üîç Link extra√≠do como texto directo: " + link);
    }

    return link;
  } catch (error) {
    Logger.log("‚ùå Error al extraer link: " + error.message);
    return "";
  }
}
